set (test_list
	string1.cpp
	string2.cpp
  vector.cpp
)

foreach (file ${test_list})
  get_filename_component (test_name ${file} NAME_WE)
	add_executable (${test_name} ${file})
	target_link_libraries (${test_name} PRIVATE 
		nirvana
		mockimport
		crtl
    crtl-main
	)
	add_test (NAME ${test_name} COMMAND ${test_name})
	add_custom_command(TARGET ${test_name} POST_BUILD
		COMMAND ${CMAKE_COMMAND} -E copy $<TARGET_RUNTIME_DLLS:${test_name}> $<TARGET_FILE_DIR:${test_name}>
		COMMAND_EXPAND_LISTS
	)
endforeach ()
